# 步骤
1. 基础需求表
2. 高级需求表
3. 框架架构图
4. 原型实现（基础功能：模块化、易扩展）
5. 迭代工程

## 基本需求
1. 客户端 API
2. 数据持久化
3. 消息消费记录
4. 消息投递策略
5. 消息消费策略

## 高级需求
1. 主题分区
2. 分区副本
3. 消息同步
4. 事务消息

## 应用
1. 单实例消息队列
2. 客户端 API

## 开发
 
                                          /
                                         XiMQ
                                  /     |     \     \
                             Topic   broker  consumer producer
                           [T1,T2,T3]  
                          /        \   
                  partition         group_c/group_p    
                  [p1,p2,p3]        [g1,g2,g3]
                    /   \           /    \
          topic-i,broker;replic... consumer Coordinator
                                  /\     [消费分组管理]
                                 /  \        
                    监听触发消费分配    ping     
               

--------------------------------------------------------------------
                 
                 
  |分区  ISR 
  |------------------------------
  |主   Epoch  HW  LEO   RLEO
  |------------------------------
  |从   fetch  
  
  
--------------------------------------------------------------------
   
   
          /  producer - ack
   client 
          \ 
             consumer  - commit
             
--------------------------------------------------------------------


  |持久化
  |--------------------------------------------------------------------
  |文件 - 主题 - 分区/分块 LogSegement  - 查询 index/timeindex   position/文件指针
  |--------------------------------------------------------------------
  |清理 - 压缩 - 
  |--------------------------------------------------------------------
  |页缓存 - 零拷贝
  |--------------------------------------------------------------------
  |消息消费记录 commit_offset_partition_x   分区
  --------------------------------------------------------------------






